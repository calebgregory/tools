#!/usr/bin/env bash
#MISE description="Detect silence intervals in audio file using ffmpeg"
set -euo pipefail

in="${1:?usage: mise run audio:split:detect-silence <input.mp4|audio.m4a> <workdir>}"
workdir="${2:?usage: mise run audio:detect_silence <input> <workdir>}"

mkdir -p "$workdir"
log="$workdir/silence.log"

# Tune noise/d as needed
ffmpeg -hide_banner -i "$in" -vn \
  -af "silencedetect=noise=-35dB:d=0.4" \
  -f null - 2> "$log"

echo "Wrote: $log"
